frecent-dirs () {
    _histdb_init
    local now="$(date +%s)"
    _histdb_query -separator "\n" \
                  "
select places.dir
from history left join places on history.place_id = places.rowid
where places.host = ${HISTDB_HOST}
and places.dir != '$(sql_escape $PWD)'
and places.dir like '%$(sql_escape ${1:-${PWD}})%'
group by places.dir
order by sum(1000.0/($now - history.start_time)) desc
limit 25
" | while read d; do
        ( [[ $d = "/net/*" ]] || [[ -d $d ]] ) && echo $d
    done
}